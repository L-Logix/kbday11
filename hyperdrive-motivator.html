<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Motivator Recovery — Terminal</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: 'Share Tech Mono', monospace;
      margin: 0;
      padding: 40px;
    }
    #terminal {
      max-width: 760px;
      margin: 0 auto;
      border: 1px solid #0f0;
      border-radius: 8px;
      padding: 24px;
      background: #010;
      box-shadow: 0 0 20px rgba(0,255,0,0.08);
    }
    .line { white-space: pre-wrap; margin: 8px 0; }
    .muted { color: #66ff66a0; }
    .error { color: #ff6666; }
    .success { color: #66ff66; font-weight: bold; }
    .controls { margin-top: 18px; display: flex; gap: 8px; align-items: center; }
    input[type="text"] {
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 8px 10px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 16px;
      border-radius: 4px;
      width: 200px;
      outline: none;
    }
    button {
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 8px 12px;
      font-family: 'Share Tech Mono', monospace;
      cursor: pointer;
      border-radius: 4px;
    }
    button:hover { background: #0f0; color: #000; }
    button:disabled { opacity: 0.45; pointer-events: none; }
    .cursor { display: inline-block; width: 10px; height: 18px; background: #0f0; margin-left: 6px; animation: blink 1s steps(2, start) infinite; vertical-align: middle; }
    @keyframes blink { 50% { opacity: 0; } }
  </style>
</head>
<body>
  <div id="terminal">
    <div class="line">> HYPERDRIVE MOTIVATOR ACCESS SYSTEM</div>
    <div class="line muted">> ENTER RECOVERY CODE TO RESTORE FUNCTION:</div>

    <div id="promptArea" class="controls">
      <input id="answerInput" inputmode="numeric" autocomplete="off" placeholder="Recovery code" />
      <button id="submitBtn">RECOVER</button>
    </div>

    <div id="feedback" class="line"></div>
    <div id="lockedArea" class="line success" style="display:none;">
      > MOTIVATOR STATUS: ONLINE  
      > ACCESS LOCKED — NO FURTHER ACTION AVAILABLE
    </div>
    <div id="cursor" class="cursor"></div>
  </div>

  <script>
    (function () {
      const API_URL = 'https://script.google.com/macros/s/AKfycbwCJEfr5PJguOJ79eDjA3QSiK-qe01gMIqCTTKLtjOst4bsavkNMQSx01QThXejm3UU/exec';
      const EXPECTED_ANSWER = '13';
      const SHEET_INDEX = 2;

      const promptArea = document.getElementById('promptArea');
      const lockedArea = document.getElementById('lockedArea');
      const answerInput = document.getElementById('answerInput');
      const submitBtn = document.getElementById('submitBtn');
      const feedback = document.getElementById('feedback');
      const cursor = document.getElementById('cursor');

      async function checkStatus() {
        try {
          const res = await fetch(API_URL);
          const data = await res.json();
          const current = data[SHEET_INDEX];
          if (current === 'ON') {
            promptArea.style.display = 'none';
            lockedArea.style.display = 'block';
            cursor.style.display = 'none';
          }
        } catch (err) {
          // fail silently, allow entry
        }
      }

      async function postStatus(state) {
        try {
          await fetch(`${API_URL}?index=${SHEET_INDEX}&status=${state}`, { method: 'POST' });
        } catch (e) { console.error(e); }
      }

      submitBtn.addEventListener('click', async () => {
        const val = (answerInput.value || '').trim();
        if (!val) { feedback.textContent = '> ENTER A VALUE'; feedback.className = 'line error'; return; }

        if (val === EXPECTED_ANSWER) {
          feedback.textContent = '> RECOVERY SUCCESSFUL — MOTIVATOR ONLINE';
          feedback.className = 'line success';
          submitBtn.disabled = true;
          answerInput.disabled = true;
          cursor.style.display = 'none';
          promptArea.style.opacity = '0.5';
          await postStatus('ON');
          setTimeout(() => {
            promptArea.style.display = 'none';
            lockedArea.style.display = 'block';
          }, 900);
        } else {
          feedback.textContent = '> ACCESS DENIED — TRY AGAIN';
          feedback.className = 'line error';
          answerInput.value = '';
          answerInput.focus();
        }
      });

      answerInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') submitBtn.click();
      });

      checkStatus();
    })();
  </script>
</body>
</html>
