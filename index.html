<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>Spaceship Dashboard</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');

    body {
      background: #0b0c0f;
      color: #00ff99;
      font-family: 'Orbitron', sans-serif;
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      user-select: none;
      overflow: hidden;
    }

    h1 {
      margin-bottom: 40px;
      text-align: center;
      font-weight: 700;
      letter-spacing: 0.15em;
      text-shadow:
        0 0 10px #00ff99,
        0 0 20px #00ff99;
    }

    .dashboard {
      position: relative;
      width: 600px;
      height: 600px;
      /* border: 1px solid #00ff99; Uncomment to debug */
    }

    .button-container {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: default;
      user-select: none;
      transition: transform 0.3s ease;
    }

    .button-container:hover {
      transform: scale(1.1);
      filter: drop-shadow(0 0 12px #00ff99);
      z-index: 10;
    }

    .button {
      width: 120px;
      height: 120px;
      background: #11181f;
      border-radius: 25px;
      border: 3px solid #00ff99;
      box-shadow:
        inset 0 0 20px #007f44,
        0 0 20px #00ff99;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 900;
      font-size: 1.8rem;
      color: #00ff99;
      letter-spacing: 0.1em;
      text-shadow:
        0 0 12px #00ff99;
      position: relative;
      user-select: none;
      transition: box-shadow 0.3s ease, border-color 0.3s ease, color 0.3s ease;
    }

    .button.off {
      border-color: #ff3b3b;
      box-shadow:
        inset 0 0 20px #7f0000,
        0 0 20px #ff3b3b;
      color: #ff3b3b;
      text-shadow: 0 0 12px #ff3b3b;
    }

    .main-button {
      width: 220px;
      height: 220px;
      font-size: 3.2rem;
      border-radius: 35px;
      box-shadow:
        inset 0 0 30px #007f44,
        0 0 30px #00ff99;
      transition: box-shadow 0.3s ease;
      z-index: 5;
    }

    .main-button.off {
      box-shadow:
        inset 0 0 30px #7f0000,
        0 0 30px #ff3b3b;
    }

    /* Light indicator */
    .light {
      position: absolute;
      bottom: 14px;
      right: 14px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #700000;
      box-shadow: 0 0 8px #300;
      transition: background 0.3s, box-shadow 0.3s, border-color 0.3s;
      border: 2px solid #330000;
      user-select: none;
    }

    .light.on {
      background: #0f0;
      box-shadow: 0 0 18px #0f0;
      border-color: #0a0;
    }

  </style>
</head>
<body>
  <h1>Spaceship Dashboard</h1>
  <div class="dashboard" id="dashboard">
    <!-- Buttons generated by JS -->
  </div>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbwCJEfr5PJguOJ79eDjA3QSiK-qe01gMIqCTTKLtjOst4bsavkNMQSx01QThXejm3UU/exec';
    const dashboard = document.getElementById('dashboard');

    // Positions buttons in a circle
    function positionButtons(buttonContainers, centerX, centerY, radius) {
      const count = buttonContainers.length;

      buttonContainers.forEach((container, index) => {
        if(index === 10) {
          // main button center
          container.style.left = `${centerX}px`;
          container.style.top = `${centerY}px`;
          container.style.transform = `translate(-50%, -50%)`;
          return;
        }

        // place 10 buttons in circle around center button
        // angle in radians
        const angle = (index / 10) * (2 * Math.PI) - Math.PI / 2; // start at top

        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);

        container.style.left = `${x}px`;
        container.style.top = `${y}px`;
        container.style.transform = `translate(-50%, -50%)`;
      });
    }

    function createButtons() {
      const containers = [];

      for (let i = 0; i < 11; i++) {
        const container = document.createElement('div');
        container.className = 'button-container';

        if (i === 10) {
          container.classList.add('main-button-container');
        }

        const button = document.createElement('div');
        button.className = 'button';
        if (i === 10) button.classList.add('main-button');
        button.textContent = `Btn ${i + 1}`;

        const light = document.createElement('div');
        light.className = 'light';
        light.id = `light-${i}`;

        container.appendChild(button);
        container.appendChild(light);
        dashboard.appendChild(container);

        containers.push(container);
      }

      return containers;
    }

    async function updateButtons() {
      try {
        const res = await fetch(API_URL);
        const statuses = await res.json();

        statuses.forEach((status, i) => {
          const container = dashboard.children[i];
          const button = container.querySelector('.button');
          const light = container.querySelector('.light');

          if (status === 'ON') {
            button.classList.remove('off');
            light.classList.add('on');
          } else {
            button.classList.add('off');
            light.classList.remove('on');
          }
        });
      } catch (e) {
        console.error('Failed to update button status:', e);
      }
    }

    const buttons = createButtons();

    // Position them after buttons are created
    // Dashboard center is half width and height
    const centerX = 300;
    const centerY = 300;
    const radius = 220;

    positionButtons(buttons, centerX, centerY, radius);

    updateButtons();
    setInterval(updateButtons, 3000);

    // Optional: reposition on window resize
    window.addEventListener('resize', () => {
      positionButtons(buttons, centerX, centerY, radius);
    });

  </script>
</body>
</html>
