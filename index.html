<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>Spaceship Dashboard - Client</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');

    body {
      background: #0b0c0f;
      color: #00ff99;
      font-family: 'Orbitron', sans-serif;
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      user-select: none;
      overflow: hidden;
    }

    h1 {
      margin-bottom: 40px;
      text-align: center;
      font-weight: 700;
      letter-spacing: 0.15em;
      text-shadow:
        0 0 10px #00ff99,
        0 0 20px #00ff99;
    }

    .dashboard {
      position: relative;
      width: 650px;
      height: 650px;
    }

    .button-container {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: default;
      user-select: none;
      transition: transform 0.3s ease;
    }

    .button-container:hover {
      transform: scale(1.1);
      filter: drop-shadow(0 0 12px #00ff99);
      z-index: 10;
    }

    .button {
      width: 120px;
      height: 120px;
      background: #11181f;
      border-radius: 25px;
      border: 3px solid #00ff99;
      box-shadow:
        inset 0 0 20px #007f44,
        0 0 20px #00ff99;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 900;
      font-size: 1.8rem;
      color: #00ff99;
      letter-spacing: 0.1em;
      text-shadow:
        0 0 12px #00ff99;
      position: relative;
      user-select: none;
      transition: box-shadow 0.3s ease, border-color 0.3s ease, color 0.3s ease;
    }

    .button.off {
      border-color: #ff3b3b;
      box-shadow:
        inset 0 0 20px #7f0000,
        0 0 20px #ff3b3b;
      color: #ff3b3b;
      text-shadow: 0 0 12px #ff3b3b;
    }

    /* Main (Status) button center */
    .main-button-container {
      position: absolute;
      width: 260px;
      height: 260px;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      cursor: pointer;
      user-select: none;
      z-index: 20;
    }

    .main-button {
      width: 220px;
      height: 220px;
      background: #11181f;
      border-radius: 40px;
      border: 4px solid transparent;
      box-shadow:
        inset 0 0 30px #007f44,
        0 0 30px #00ff99;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: #00ff99;
      font-weight: 900;
      letter-spacing: 0.1em;
      font-size: 2.6rem;
      position: relative;
      transition: box-shadow 0.3s ease, color 0.3s ease;
      z-index: 2;
    }

    .main-button.off {
      box-shadow:
        inset 0 0 30px #7f0000,
        0 0 30px #ff3b3b;
      color: #ff3b3b;
    }

    /* Light indicator */
    .light {
      position: absolute;
      bottom: 14px;
      right: 14px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #700000;
      box-shadow: 0 0 8px #300;
      transition: background 0.3s, box-shadow 0.3s, border-color 0.3s;
      border: 2px solid #330000;
      user-select: none;
      pointer-events: none;
    }

    .light.on {
      background: #0f0;
      box-shadow: 0 0 18px #0f0;
      border-color: #0a0;
    }

    /* Circular segmented border for main button */

    .progress-circle {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 260px;
      height: 260px;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      user-select: none;
      z-index: 1;
    }

    .progress-segment {
      position: absolute;
      width: 20px;
      height: 8px;
      background: #ff3b3b; /* red by default */
      border-radius: 4px;
      box-shadow:
        0 0 6px #7f0000;
      transition: background 0.4s ease, box-shadow 0.4s ease;
      transform-origin: center;
    }

    .progress-segment.on {
      background: #0f0;
      box-shadow:
        0 0 10px #0f0;
    }

  </style>
</head>
<body>
  <h1>Spaceship Dashboard - Client View</h1>
  <div class="dashboard" id="dashboard">
    <!-- Buttons will be created by JS -->
  </div>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbwCJEfr5PJguOJ79eDjA3QSiK-qe01gMIqCTTKLtjOst4bsavkNMQSx01QThXejm3UU/exec';
    const dashboard = document.getElementById('dashboard');

    // Status page URL (change this to your actual GitHub Pages status page)
    const STATUS_PAGE_URL = 'https://yourgithubusername.github.io/mission-status.html';

    function createButtons() {
      const containers = [];

      // Create buttons 1 to 11 in circle
      for (let i = 0; i < 11; i++) {
        const container = document.createElement('div');
        container.className = 'button-container';

        const button = document.createElement('div');
        button.className = 'button';
        button.textContent = `Btn ${i + 1}`;

        const light = document.createElement('div');
        light.className = 'light';
        light.id = `light-${i}`;

        container.appendChild(button);
        container.appendChild(light);
        dashboard.appendChild(container);

        containers.push(container);
      }

      // Create main status button (button 12)
      const mainContainer = document.createElement('div');
      mainContainer.className = 'main-button-container';

      const mainButton = document.createElement('div');
      mainButton.className = 'button main-button';
      mainButton.textContent = 'STATUS';

      mainContainer.appendChild(mainButton);

      // Create circular progress border segments (11 segments)
      const progressCircle = document.createElement('div');
      progressCircle.className = 'progress-circle';

      for (let i = 0; i < 11; i++) {
        const segment = document.createElement('div');
        segment.className = 'progress-segment';
        segment.id = `progress-segment-${i}`;

        // Position the segments evenly spaced in a circle
        const angle = (i / 11) * 360 - 90; // start at top (-90deg)
        // Place segment at radius 125px from center of progressCircle (half width 130 - segment width/2)
        const radius = 125;

        // Calculate x,y relative to center
        const rad = angle * Math.PI / 180;
        const x = 130 + radius * Math.cos(rad) - 10; // 10 = half segment width
        const y = 130 + radius * Math.sin(rad) - 4;  // 4 = half segment height

        segment.style.left = `${x}px`;
        segment.style.top = `${y}px`;
        segment.style.transform = `rotate(${angle + 90}deg)`; // rotate so segment aligns tangentially

        progressCircle.appendChild(segment);
      }

      mainContainer.appendChild(progressCircle);
      dashboard.appendChild(mainContainer);

      // Add click event to main button
      mainButton.addEventListener('click', () => {
        window.location.href = STATUS_PAGE_URL;
      });

      containers.push(mainContainer);

      return containers;
    }

    // Positions 11 buttons evenly around center button
    function positionButtons(buttonContainers, centerX, centerY, radius) {
      // First 11 buttons (0-10) around circle
      for (let i = 0; i < 11; i++) {
        const container = buttonContainers[i];
        // Calculate angle for even spacing
        const angle = (i / 11) * (2 * Math.PI) - Math.PI / 2; // start from top

        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);

        container.style.left = `${x}px`;
        container.style.top = `${y}px`;
        container.style.transform = 'translate(-50%, -50%)';
      }

      // Main button (index 11) center (already positioned absolute with CSS)
      const mainContainer = buttonContainers[11];
      // Positions handled by CSS (.main-button-container), so no changes here
    }

    // Update button lights and progress ring based on API data
    async function updateButtons() {
      try {
        const res = await fetch(API_URL);
        const statuses = await res.json();

        // Update buttons 1 to 11
        for(let i = 0; i < 11; i++) {
          const container = dashboard.children[i];
          const button = container.querySelector('.button');
          const light = container.querySelector('.light');
          const progressSegment = document.getElementById(`progress-segment-${i}`);

          if (statuses[i] === 'ON') {
            button.classList.remove('off');
            light.classList.add('on');
            progressSegment.classList.add('on');
          } else {
            button.classList.add('off');
            light.classList.remove('on');
            progressSegment.classList.remove('on');
          }
        }

        // Optionally update main button style based on overall status
        const allOn = statuses.every(status => status === 'ON');
        const mainButton = dashboard.children[11].querySelector('.main-button');
        if (allOn) {
          mainButton.classList.remove('off');
        } else {
          mainButton.classList.add('off');
        }

      } catch (e) {
        console.error('Failed to update button status:', e);
      }
    }

    // Initialize
    const buttons = createButtons();

    const centerX = 325; // half of dashboard width 650px
    const centerY = 325; // half of dashboard height
    const radius = 250;

    positionButtons(buttons, centerX, centerY, radius);

    updateButtons();
    setInterval(updateButtons, 3000);

    // Reposition on resize (optional)
    window.addEventListener('resize', () => {
      positionButtons(buttons, centerX, centerY, radius);
    });
  </script>
</body>
</html>
