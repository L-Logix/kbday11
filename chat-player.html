<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chat - Kai</title>
<style>
body{background:#0b0c0f;color:#00ff99;font-family:monospace;margin:0;padding:0;display:flex;flex-direction:column;height:100vh;}
#chatContainer{flex:1; overflow-y:auto; padding:10px;}
.message{margin:5px 0;padding:8px 12px;border-radius:12px;max-width:70%;word-wrap:break-word;}
.kai{background:#007f44;color:#0f0;align-self:flex-end;}
.manager{background:#004466;color:#00ff99;align-self:flex-start;}
#inputContainer{display:flex;padding:10px;border-top:1px solid #00ff99;}
#messageInput{flex:1;padding:10px;background:#11181f;border:2px solid #00ff99;border-radius:10px;color:#00ff99;}
#sendBtn{padding:10px;background:#00ff99;color:#0b0c0f;border:none;margin-left:5px;border-radius:10px;cursor:pointer;}
</style>
</head>
<body>
<div id="chatContainer"></div>
<div id="inputContainer">
<input type="text" id="messageInput" placeholder="Type a message">
<button id="sendBtn">Send</button>
</div>

<script>
const API_URL='https://script.google.com/macros/s/AKfycbxvrgcHuMbV30TUTlYUs8p9doWgqCiNp-JTUK5nfcY43tbFIuSag_xbkQQ8zdmCihBf/exec';
const chatContainer=document.getElementById('chatContainer');
const input=document.getElementById('messageInput');
const sendBtn=document.getElementById('sendBtn');

async function loadMessages(){
  try{
    const res=await fetch(API_URL); const data=await res.json();
    chatContainer.innerHTML='';
    data.forEach(m=>{
      const div=document.createElement('div'); div.className='message '+(m.Sender==='Kai'?'kai':'manager'); div.textContent=`${m.Sender}: ${m.Message}`; chatContainer.appendChild(div);
    });
    chatContainer.scrollTop=chatContainer.scrollHeight;
  }catch(e){console.error(e);}
}

let sending=false;
async function sendMessage(){
  if(sending) return;
  const msg=input.value.trim(); if(!msg) return;
  sending=true;
  try{
    await fetch(API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({Sender:'Kai',Message:msg})});
    input.value=''; loadMessages();
  }catch(e){console.error(e);}
  sending=false;
}

sendBtn.addEventListener('click',sendMessage);
input.addEventListener('keydown',e=>{if(e.key==='Enter'){sendMessage();}});

loadMessages(); setInterval(loadMessages,3000);
</script>
</body>
</html>
